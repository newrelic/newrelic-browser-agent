<!DOCTYPE html>
<html>
<head>
  <title>XHR - Entity GUID</title>
  {init} {config} {loader}
</head>
<body>
<div>
  This page initiates an XHR with a NR entity guid header.
</div>
<script>
 window.app1 = newrelic.register({
    licenseKey: NREUM.info.licenseKey, // testing server is set up to only accept this licenseKey
    applicationID: 1, // reports to app 1
  }).on('ready', ({metadata}) => {
    var xhr = new XMLHttpRequest()
    xhr.open('GET', '/json')
    xhr.setRequestHeader('X-Newrelic-Entity-Guid', metadata.target.entityGuid)
    xhr.send()
  }).on('error', (err) => {
    newrelic.noticeError(err)
  })

  window.app2 = newrelic.register({
    licenseKey: NREUM.info.licenseKey, // testing server is set up to only accept this licenseKey
    applicationID: 2, // reports to app 2
  }).on('ready', ({metadata}) => {
    var xhr = new XMLHttpRequest()
    xhr.open('GET', '/json')
    xhr.setRequestHeader('X-Newrelic-Entity-Guid', metadata.target.entityGuid)
    xhr.send()
  }).on('error', (err) => {
    newrelic.noticeError(err)
  })
</script>
</body>
</html>
