<!DOCTYPE html>
<!--
  Copyright 2020 New Relic Corporation.
  PDX-License-Identifier: Apache-2.0
-->
<html>
  <head>
    <title>RUM Unit Test</title>
    {init} {config}
    <script>
      NREUM.init.harvest.interval = 30;
      NREUM.init.ajax.block_internal = true; // Enable blocking of internal AJAX requests
    </script>
    {loader}
  </head>
  <body>
    <button>Click me for ajax</button>
    <script>
      // make all compatible events harvest early by setting a jsAttributes size that exceeds the ideal payload size
      newrelic.setCustomAttribute("foo", "bar".repeat(16000));
      newrelic.addPageAction("test");
      newrelic.log("test");
      window.sendAjax = function () {
        fetch("https://pokeapi.co/api/v2/pokemon/moltres");
      };

      // This will create a trace node with a long name, which should be harvested early
      newrelic.addToTrace({ name: "foo".repeat(16000), start: Date.now() });
    </script>
  </body>
</html>
