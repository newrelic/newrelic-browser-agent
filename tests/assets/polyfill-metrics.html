<!DOCTYPE html>
<!--
  Copyright 2020 New Relic Corporation.
  PDX-License-Identifier: Apache-2.0
-->
<html>
<head>
  <title>Polyfill Integration Test</title>
  <script type="text/javascript">
    /*
    DO NOT test Function.prototype.apply, having all three function
    prototype methods polyfilled will cause recursion error
    */

    var originalFunctionCallFn = Function.prototype.call
    Function.prototype.call = function (that, ...args) {
      return originalFunctionCallFn.apply(this, [that, ...args])
    }

    var originalFunctionBindFn = Function.prototype.bind
    Function.prototype.bind = function (that, ...args) {
      return originalFunctionBindFn.apply(this, [that, ...args])
    }

    var originalArrayIncludesFn = Array.prototype.includes
    Array.prototype.includes = function (...args) {
      return originalArrayIncludesFn.apply(this, args)
    }

    var originalArrayFromFn = Array.from
    Array.from = function (...args) {
      return originalArrayFromFn.apply(this, args)
    }

    var originalArrayFindFn = Array.prototype.find
    Array.prototype.find = function (...args) {
      return originalArrayFindFn.apply(this, args)
    }

    var originalArrayFlatFn = Array.prototype.flat
    Array.prototype.flat = function (...args) {
      return originalArrayFlatFn.apply(this, args)
    }

    var originalArrayFlatMapFn = Array.prototype.flatMap
    Array.prototype.flatMap = function (...args) {
      return originalArrayFlatMapFn.apply(this, args)
    }

    var originalObjectAssignFn = Object.assign
    Object.assign = function (...args) {
      return originalObjectAssignFn.apply(this, args)
    }

    var originalObjectEntriesFn = Object.entries
    Object.entries = function (...args) {
      return originalObjectEntriesFn.apply(this, args)
    }

    var originalObjectValuesFn = Object.values
    Object.values = function (...args) {
      return originalObjectValuesFn.apply(this, args)
    }

    var originalMapCtr = Map
    Map = function (...args) {
      return new originalMapCtr(...args)
    }

    var originalSetCtr = Set
    Set = function (...args) {
      return new originalSetCtr(...args)
    }

    var originalWeakMapCtr = WeakMap
    WeakMap = function (...args) {
      return new originalWeakMapCtr(...args)
    }

    var originalWeakSetCtr = WeakSet
    WeakSet = function (...args) {
      return new originalWeakSetCtr(...args)
    }
    </script>
  {init}
  {config}
  {loader}
</head>
<body>
  this is a generic page that is instrumented by the JS agent
</body>
</html>
